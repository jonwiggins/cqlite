# Basic sqllogictest for cqlite

statement ok
CREATE TABLE t1(a INTEGER, b TEXT, c REAL)

statement ok
INSERT INTO t1 VALUES(1, 'hello', 3.14)

statement ok
INSERT INTO t1 VALUES(2, 'world', 2.72)

statement ok
INSERT INTO t1 VALUES(3, 'foo', 1.0)

query I rowsort
SELECT a FROM t1
----
1
2
3

query T rowsort
SELECT b FROM t1
----
foo
hello
world

query I nosort
SELECT COUNT(*) FROM t1
----
3

query ITR rowsort
SELECT a, b, c FROM t1 WHERE a > 1
----
2
world
2.720
3
foo
1.000

query I nosort
SELECT a FROM t1 WHERE b = 'hello'
----
1

query I nosort
SELECT SUM(a) FROM t1
----
6

query I rowsort
SELECT a FROM t1 WHERE a BETWEEN 1 AND 2
----
1
2

query I nosort
SELECT a FROM t1 ORDER BY a DESC LIMIT 1
----
3

statement ok
CREATE TABLE t2(x INTEGER, y INTEGER)

statement ok
INSERT INTO t2 VALUES(1, 10)

statement ok
INSERT INTO t2 VALUES(2, 20)

query II rowsort
SELECT t1.a, t2.y FROM t1 INNER JOIN t2 ON t1.a = t2.x
----
1
10
2
20

query I nosort
SELECT a FROM t1 WHERE b IS NOT NULL ORDER BY a
----
1
2
3

statement ok
UPDATE t1 SET b = 'updated' WHERE a = 1

query T nosort
SELECT b FROM t1 WHERE a = 1
----
updated

statement ok
DELETE FROM t1 WHERE a = 3

query I nosort
SELECT COUNT(*) FROM t1
----
2
